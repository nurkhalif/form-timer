<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Panel</title>
</head>
<body>
  <h2>Admin Settings</h2>
  <label>Form Link: <input id="formLink"></label><br>
  <label>Minutes: <input id="minutes" type="number"></label><br>
  <label>Quiz Name: <input id="quizName"></label><br>
  <button onclick="saveSettings()">Save to GitHub</button>

  <p id="status"></p>

<script>
async function saveSettings() {
  const settings = {
    form: document.getElementById("formLink").value,
    minutes: parseInt(document.getElementById("minutes").value),
    name: document.getElementById("quizName").value
  };

  const content = btoa(JSON.stringify(settings, null, 2)); // base64

  // ⚠️ Replace with your repo info
  const repo = "nurkhalif/form-timer";
  const filePath = "settings.json";
  const token = "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"; // ⚠️ create from GitHub Settings > Developer Settings > PAT

  // Get current file sha
  const res = await fetch(`https://api.github.com/repos/${repo}/contents/${filePath}`);
  const fileData = await res.json();

  // Update file
  const updateRes = await fetch(`https://api.github.com/repos/${repo}/contents/${filePath}`, {
    method: "PUT",
    headers: {
      "Authorization": `token ${token}`,
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      message: "Update quiz settings",
      content: content,
      sha: fileData.sha
    })
  });

  if (updateRes.ok) {
    document.getElementById("status").innerText = "✅ Settings saved to GitHub!";
  } else {
    document.getElementById("status").innerText = "❌ Error saving settings.";
  }
}
</script>
</body>
</html>
